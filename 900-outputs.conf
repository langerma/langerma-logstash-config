output {
  if "pfsense" in [tags] {
    elasticsearch {
      hosts => localhost
      index => "pfsense-%{+YYYY.MM.dd}"
    }
  }
  else if "hpswitch" in [tags] {
    elasticsearch {
      hosts => localhost
      index => "hp-%{+YYYY}"
    }
  }
  else if "freenas" in [tags] {
    elasticsearch {
      hosts => localhost
      index => "freenas-%{+YYYY.MM}"
    }
  }
  else if [fields][middleware]=="squid.json" {
    elasticsearch {
      hosts => localhost
      index => "squid-json-%{+YYYY.MM}"
    }
  }
  else if [fields][middleware]=="squid" {
    elasticsearch {
      hosts => localhost
      index => "squid-access-%{+YYYY.MM}"
    }
  }
  else if [fields][middleware]=="elasticsearch" {
    elasticsearch {
      hosts => localhost
      index => "elasticsearch-%{+YYYY.MM}"
    }
  }
  else if [middleware]=="hbase" {
    elasticsearch {
      hosts => localhost
      index => "hbase-%{+YYYY.MM}"
    }
  }
  else if [middleware]=="hadoop" {
    elasticsearch {
      hosts => localhost
      index => "hadoop-%{+YYYY.MM}"
    }
  }
  else if "haproxy" in [tags] {
    elasticsearch {
      index => "haproxy-%{+YYYY.MM}"
      hosts => [ "127.0.0.1:9200" ]
      #template => "/app/logstash/conf.d/mappings/haproxy.json"
      #template_name => "haproxy"
      #template_overwrite => "true"
    }
  }
  else if "nmap" in [tags] {
    elasticsearch {
      index => "nmap-%{+YYYY}"
      hosts => [ "127.0.0.1:9200" ]
      template => "/app/logstash/conf.d/mappings/nmap.json"
      template_name => "nmap"
      template_overwrite => "true"
    }
  }
  else if [fileset][module]=="apache2" {
    elasticsearch {
      hosts => ["http://localhost:9200"]
      index => "apache-%{+YYYY.MM}"
    }
  }
  else {
    elasticsearch {
      hosts => ["http://localhost:9200"]
      index => "else-%{+YYYY.MM}"
      #user => "elastic"
      #password => "changeme"
    }
  }
}
